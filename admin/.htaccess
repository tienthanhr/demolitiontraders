## Prevent direct access to frontend/admin copies
RewriteEngine On

# Allow static assets (CSS, JS, fonts, images)
RewriteCond %{REQUEST_URI} \.(css|js|jpg|jpeg|png|gif|svg|ico|woff|woff2|ttf|eot|map)$ [NC]
RewriteRule ^ - [L]

# Allow index.php (main entry point)
RewriteCond %{REQUEST_URI} /admin/index\.php$ [NC]
RewriteRule ^ - [L]

# Allow access when coming from same directory (no referer or admin referer)
# Support subfolder installs like /demolitiontraders/admin/
RewriteCond %{REQUEST_URI} \.php$ [NC]
RewriteCond %{HTTP_REFERER} ^$ [OR]
RewriteCond %{HTTP_REFERER} ^https?://[^/]+(/.*)?/admin/ [NC]
RewriteRule ^ - [L]

# Block all other direct PHP access
RewriteCond %{REQUEST_URI} \.php$ [NC]
RewriteRule ^ - [F,L]

# Custom error page
ErrorDocument 403 "Access Denied - Please use the admin panel interface"
